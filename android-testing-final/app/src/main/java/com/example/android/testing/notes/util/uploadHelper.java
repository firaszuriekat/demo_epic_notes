package com.example.android.testing.notes.util;import android.os.Environment;import android.support.design.widget.Snackbar;import android.util.Log;import com.example.android.testing.notes.R;import com.example.android.testing.notes.data.NotesServiceApiEndpoint;import com.example.android.testing.notes.data.Patient;import com.poiji.bind.Poiji;import com.poiji.exception.PoijiExcelType;import com.poiji.option.PoijiOptions;import java.io.BufferedInputStream;import java.io.File;import java.io.FileInputStream;import java.io.IOException;import java.io.InputStream;import java.util.List;public class uploadHelper {    public static final String TAG=uploadHelper.class.getSimpleName();    public static final String ACTION_DETAILS_DEEP_LINK_METHOD = "details_deep_link";    public static List<Patient> uploadExcel(){         InputStream stream=null;        List<Patient> patients=null;        try {            //mActionListener.takePicture();            PoijiOptions options = PoijiOptions.PoijiOptionsBuilder.settings(0).build();            stream=openFileFromInternal("patients.xls");            patients = Poiji.fromExcel(stream, PoijiExcelType.XLS, Patient.class, options);            patients.size();// 3            Patient firstPatient = patients.get(0);            Log.e("TAG", "Patient{rowIndex=1, employeeId=123923, name='Joe', surname='Doe', age=30, single=true, birthday='4/9/1987'}");            Log.e("TAG","details="+firstPatient.toString());            NotesServiceApiEndpoint.addNotes(patients);        } catch (Exception ioe) {            Log.e(TAG,"ioe="+ioe.toString());        }  finally {            if(stream !=null) {                try {                    stream.close();                } catch (IOException e) {                    e.printStackTrace();                }            }        }        return patients;    }    static InputStream openFileFromInternal(String file) {        File sdCard = Environment.getExternalStorageDirectory();        File dir = new File(sdCard.getAbsolutePath() + "/Download");        File cert = new File(dir, "patients.xls");        InputStream isCert = null;        try {            isCert = new BufferedInputStream(new FileInputStream(cert));            Log.d(TAG, "Sucsess!");            return isCert;        } catch (Exception e) {            Log.d(TAG, "Could not load the file");            return null;        }    }}